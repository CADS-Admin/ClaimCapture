@(breaksForm: Form[models.domain.CircumstancesBreaksInCare])(implicit claim: models.domain.Claim, lang: Lang, request: Request[AnyContent])

@import utils.helpers.CarersTemplate._
@import views.html.helper.dates._
@import views.html.helper._
@import views.html.helper.base._
@import utils.helpers.CarersCrypto
@import views.html.circs.s2_report_changes.main
@import play.api.i18n.{MMessages => Messages}
@import app.CircsBreaksWhereabouts._

@circsWhereWasThePersonList = @{
    Seq(
        Hospital -> Html(Messages("circsBreaks.inhospital")),
        RespiteCare -> Html(Messages("circsBreaks.inrespitecare")),
        Holiday -> Html(Messages("circsBreaks.onholiday")),
        Home -> Html(Messages("circsBreaks.athome")),
        SomewhereElse -> Html(Messages("circsBreaks.somewhereelse")))
}

@circsWhereWereList = @{
    Seq(
        Hospital -> Html(Messages("circsBreaks.inhospital")),
        Holiday -> Html(Messages("circsBreaks.onholiday")),
        Home -> Html(Messages("circsBreaks.athome")),
        SomewhereElse -> Html(Messages("circsBreaks.somewhereelse")))
}

@main(Messages("c2.g7") + " - " + Messages("c2.name")) {
    @errorsSummary(breaksForm)

    @form(action = controllers.circs.s2_report_changes.routes.G7BreaksInCare.submit) {
        <div class="form-wrap">
            <fieldset class="form-elements">

                <legend>@Messages("c2.g7")</legend>

                <ul>
                   <li>@Html(Messages("circsBreaksMessage"))</li>

                    @sliderHelp(Messages("circsBreaksHelp.label"),Messages("circsBreaksHelp.closeLabel"),Html(Messages("circsBreaksHelp")))
                </ul>

            </fieldset>

            <fieldset class="form-elements">

                <ul>
                    @dateTimePickerWithDynamicLabel(breaksForm("breaksInCareStartDate"), 'dynamicDateDays-> 34)

                    @carersInputText(breaksForm("breaksInCareStartTime"), 'helperAbove-> Html(Messages("breaksInCareStartTime.helper")), 'maxLength -> 10)

                    @listRadioGroupWithOther(breaksForm("wherePersonBreaksInCare.answer"),
                        'items -> circsWhereWasThePersonList,
                            'helperAbove-> Messages("wherePersonBreaksInCare.helper"),
                            'id -> "wherePersonBreaksInCare",
                            'textAreaHelper -> Html(Messages("60charsLeft")), 'maxLength -> 60,
                            'display -> {if (breaksForm("wherePersonBreaksInCare.answer").value.getOrElse("no") == SomewhereElse) "yes" else "no" }
                    )

                    @listRadioGroupWithOther(breaksForm("whereYouBreaksInCare.answer"),
                        'items -> circsWhereWereList,
                            'helperAbove-> Messages("whereYouBreaksInCare.helper"),
                            'id -> "whereYouBreaksInCare",
                            'textAreaHelper -> Html(Messages("60charsLeft")), 'maxLength -> 60,
                            'display -> {if (breaksForm("whereYouBreaksInCare.answer").value.getOrElse("no") == SomewhereElse) "yes" else "no" }
                    )

                    @yesNoRadioGroup(breaksForm("breakEnded.answer"))

                    @otherDetailPlaceHolder(
                        inputDef = Seq(
                            dateTimePickerWithDynamicLabel(breaksForm("breakEnded.endDate"), 'ignoreOptional -> true, 'dynamicDateDays-> 27),
                            carersInputText(breaksForm("breakEnded.endTime"), 'helperAbove-> Html(Messages("breakEnded.endTime.helper")), 'maxLength -> 10)
                         ),
                        'id -> "breakEndedDateTime",
                        'display ->  { if (breaksForm("breakEnded.answer").value.getOrElse("no") == "yes") "yes" else "no" }
                    )

                    @otherDetailPlaceHolder(
                        inputDef = Seq(yesNoRadioGroup(breaksForm("expectStartCaring.answer"),
                            'values -> Seq("yes" -> Html(Messages("label.yes7")), "no" -> Html(Messages("label.no")), "dontknow" -> Html(Messages("label.dontknow"))),
                            'ignoreOptional -> true)),
                            'id -> "expectStartCaring",
                            'display ->  { if (breaksForm("breakEnded.answer").value.getOrElse("yes") == "no") "yes" else "no" }
                    )

                    @otherDetailPlaceHolder(
                        inputDef = Seq(
                            dateTimePickerWithDynamicLabel(breaksForm("expectStartCaring.expectStartCaringDate"), 'dynamicDateDays-> -7)
                        ),
                        'id -> "expectStartCaringDate",
                        'display ->  { if (breaksForm("expectStartCaring.answer").value.getOrElse("no") == "yes") "yes" else "no" }
                    )

                    @otherDetailPlaceHolder(
                        inputDef = Seq(
                            dateTimePickerWithDynamicLabel(breaksForm("expectStartCaring.permanentBreakDate"), 'ignoreOptional -> true, 'dynamicDateDays-> 27)
                        ),
                        'id -> "permanentBreakDate",
                        'display ->  { if (breaksForm("expectStartCaring.answer").value.getOrElse("yes") == "no") "yes" else "no" }
                    )

                    @yesNoRadioGroup(breaksForm("medicalCareDuringBreak"),'values -> Seq("yes" -> Html(Messages("label.yes3")), "no" -> Html(Messages("label.no"))))

                    @carersInputTextArea(breaksForm("moreAboutChanges"), 'helperAbove-> Html(Messages("moreAboutChanges.helper")), 'helper -> Html(Messages("300charsLeft")), 'maxLength -> 300)

                </ul>

            </fieldset>

            <nav class="form-steps">
                <a id="backButton" href="@claim.navigation.previous" class="button secondary" aria-label="@Html(Messages("form.back.help"))">@Html(Messages("form.back"))</a>
                <button type="submit" name="action" value="next" class="button" aria-label="@Html(Messages("form.next.help"))">@Html(Messages("form.next"))</button>
            </nav>
        </div>
    }
}

<script type="text/javascript" src='@routes.Assets.at("javascripts/circs/s2_report_changes/g7_breaksFromCaring.js")'></script>
<script type="text/javascript" src='@routes.Assets.at("javascripts/listWithOther.js")'></script>
<script type="text/javascript" src='@routes.Assets.at("javascripts/textAreaCounter.js")'></script>

<script type="text/javascript">
$(function(){
window.areaCounter({selector:"@CarersCrypto.encryptAES("wherePersonBreaksInCare_answer_wherePersonBreaksInCare_Somewhere_else")",maxChars:60});
window.areaCounter({selector:"@CarersCrypto.encryptAES("whereYouBreaksInCare_answer_whereYouBreaksInCare_Somewhere_else")",maxChars:60});
window.areaCounter({selector:"@CarersCrypto.encryptAES("moreAboutChanges")",maxChars:300});
})
$(function(){
window.initEvents("@CarersCrypto.encryptAES("breakEnded_answer_yes")",
"@CarersCrypto.encryptAES("breakEnded_answer_no")",
"@CarersCrypto.encryptAES("expectStartCaring_answer_yes")",
"@CarersCrypto.encryptAES("expectStartCaring_answer_no")",
"@CarersCrypto.encryptAES("expectStartCaring_answer_dontknow")"
);
});
</script>
