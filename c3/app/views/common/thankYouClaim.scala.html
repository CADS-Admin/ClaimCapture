@(lang: Lang)(implicit claim: models.domain.Claim, request: Request[AnyContent],flash:Flash, messages: Messages)

@import app.ConfigProperties._
@import models.domain._
@import utils.helpers.HtmlLabelHelper.displayPlaybackDatesFormat
@import play.api.Play
@import play.api.Play.current
@import controllers.mappings.Mappings
@import play.api.Logger

@isEmployment = @{
    Employed.isEmployed(claim)
}
@isSelfEmployment = @{
    SelfEmployment.isSelfEmployed(claim)
}
@hasStatutorySickPay = @{
    OtherMoney.receivesStatutorySickPay(claim)
}
@hasOtherStatutoryPay = @{
    OtherMoney.receivesOtherStatutoryPay(claim)
}
@evidenceRequired = @{
    isEmployment || isSelfEmployment || hasStatutorySickPay || hasOtherStatutoryPay
}
@claimDate = @{
    claim.questionGroup[ClaimDate].getOrElse(ClaimDate()).dateOfClaim
}
@displayDateForLabel = @{
    displayPlaybackDatesFormat(lang, claimDate)
}

@isEmail = @{
    getProperty("email.frontend",false) && claim.questionGroup[ContactDetails].getOrElse(ContactDetails()).wantsContactEmail == Mappings.yes
}

@isOriginGB = @{
    getProperty("origin.tag", "GB") match {
        case "GB" => true
        case _ => false
    }
}

@common.govMain(messages("thankyou")) {

<div class="carers-allowance clearfix" data-journey="carers-allowance:page:thank-you">

    @common.protoType()

    <div class="grid-row main-grid">

        <aside class="column-quarter sidebar @{ 
        if(!evidenceRequired) "no-employment"
        }" id="sidebar" role="complementary" aria-labelledby="helpcontent">

            <section class="font-xsmall" id="help">

                <h2 class="heading-medium compound">@Html(messages("leftcol.title"))</h2>

                @if((!request.uri.startsWith("/claim-help"))) {
                    <p class="compound">
                        <a id="helppage" rel="external" href="/claim-help" target="_blank" @views.html.ga.trackClickEvent(linkName = "Claim Notes - Left Column")>@Html(messages("leftcol.guide"))</a>
                    </p>
                }

                <h3 class="heading-small compound">@Html(messages("leftcol.helpline"))</h3>

                <p class="compound">@Html(messages("leftcol.helplinecontent.1"))</p>
                @if(isOriginGB) {
                    <p class="compound">@Html(messages("leftcol.helplinecontent.2"))</p>
                }
                <p class="compound">@Html(messages("leftcol.helplinecontent.3"))</p>
                @if(isOriginGB) {
                    <p class="compound">@Html(messages("leftcol.helplinecontent.4"))</p>
                    <p class="compound">@messages("leftcol.callcharges")</p>
                }

            </section>

        </aside>

        <article class="column-three-quarters main-content finish-statement">

            <section class="app-complete">
                <h1 class="form-title heading-large compound">@Html(messages("thankyou"))</h1>
                <p class="nino-title">@Html(messages("claim.recieved2"))</p>
            </section>

            <p class="hide-desktops">@Html(messages("claim.feedback.link"))</p>

            <div class="finish-info">

                <h2 class="heading-medium">@Html(messages("next"))</h2>

                @if(isEmail){
                    <p>@Html(messages("email.claim.thankYou"))</p>
                }
                @if(evidenceRequired) {
                    <p>@Html(messages("claim.next.main"))</p>
                } else {
                    <p>@Html(messages("claim.next.nodocuments.1"))</p>
                }

                @if(evidenceRequired) {

                    <div class="send-info">

                        <h2 class="heading-medium">@Html(messages("evidence.required"))</h2>

                        <p>@Html(messages("thankyou.send"))</p>

                        <ul class="list-bullet">
                            @if(isEmployment) {
                                <li>@Html(messages("evidence.employment.lastPayslip", displayDateForLabel))</li>
                                <li id="employment" >@Html(messages("evidence.employment.payslipsSinceClaimDate"))</li>
                            }
                            @if(isSelfEmployment) {
                                <li id="selfEmployment">@Html(messages("evidence.selfEmployment.accounts"))</li>
                            }
                            @if(ClaimUtils.pensionStatementsRequired(claim)) {
                                <li>@messages("evidence.pensionStatements")</li>
                            }
                            @if(hasStatutorySickPay) {
                                <li>@messages("evidence.otherMoney.statutorySickPay")</li>
                            }
                            @if(hasOtherStatutoryPay) {
                                <li>@messages("evidence.otherMoney.otherStatutoryPay")</li>
                            }
                        </ul>

                        <p>@Html(messages("address.send"))</p>

                        <p>
                            <span><b>@Html(messages("s11.g5.help11"))</b></span><br />
                            <span>@Html(messages("s11.g5.help12"))</span><br />
                            <span>@Html(messages("s11.g5.help13"))</span><br />
                            <span>@Html(messages("s11.g5.help14"))</span><br />
                            @if(!isOriginGB) {
                                <span>@Html(messages("s11.g5.help14.pc"))</span>
                            }
                        </p>

                        <p>@Html(messages("address.details"))</p>

                    </div>

                }

            </div>

            <br />

            <p><a rel="external" href="@Html(messages("thankyou.report.change.url"))" target="_blank">@Html(messages("thankyou.report.change"))</a></p>

            <div class="finish-button">@Html(messages("claim.feedback.link"))</div>

        </article>

        @if(getProperty("display.transid", false)) {
            <input type="hidden" name="transId" id="transId" value="@{ claim.transactionId.getOrElse("NO_TRANS_ID") }"/>
        }

    </div>

</div>

}


<script type="text/javascript">
$ ( function ( ) {
    @if(!Play.isTest) {
        trackEvent ( "times", "claim - end" );
        var eligibility = getCookie('claimeligibility');
        var start = getCookie('claimstart');
        var now = new Date().getTime();
        var durationFromEligibility = now - eligibility;
        var durationFromStart = now - start;
        trackTiming('TimeToCompletion','Claim from eligibility', durationFromEligibility);
        trackTiming('TimeToCompletion','Claim from start', durationFromStart);
    }
    @ga.stagePrompt()
} )
</script>
