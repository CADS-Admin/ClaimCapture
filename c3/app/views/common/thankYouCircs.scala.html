@()(implicit circs: models.domain.Claim, lang: Lang, request: Request[AnyContent])


@import models.domain.CircumstancesBreaksInCare
@import models.domain.CircumstancesEmploymentChange
@import models.domain.CircumstancesStartedEmploymentAndOngoing
@import models.domain.CircumstancesStartedAndFinishedEmployment
@import models.domain.CircumstancesEmploymentNotStarted

@import play.api.i18n._
@import play.api.i18n.{MMessages => Messages}

@showBreaksInCareMessages = @{
    var breaksIncare = circs.questionGroup[CircumstancesBreaksInCare].getOrElse(CircumstancesBreaksInCare())
    breaksIncare.expectStartCaring.answer match {
            case Some(n) => n match {
                case Mappings.yes => if(!breaksIncare.expectStartCaring.expectStartCaringDate.isDefined) true else false
                case Mappings.dontknow => true
                case _ => false
            }
            case _ => false
        }
}

@showEmployment1Messages = @{
    var employmentChange = circs.questionGroup[CircumstancesEmploymentChange].getOrElse(CircumstancesEmploymentChange())
    employmentChange.typeOfWork.answer match {
        case "employed" => {
            employmentChange.hasWorkStartedYet.answer match {
                case "yes" => {
                    if(employmentChange.hasWorkFinishedYet.answer.getOrElse("yes") == "no") true
                    else false
                }
                case _ => true
            }
        }
        case _ => false
    }
}

@showEmployment2Messages = @{
    var employmentChange = circs.questionGroup[CircumstancesEmploymentChange].getOrElse(CircumstancesEmploymentChange())
    employmentChange.typeOfWork.answer match {
        case "employed" => {
            employmentChange.hasWorkStartedYet.answer match {
                case "yes" => {
                    if(employmentChange.hasWorkFinishedYet.answer.getOrElse("no") == "yes") true
                    else false
                }
                case _ => true
            }
        }
        case _ => false
    }
}

@showEmploymentPensionMessage = @{
    lazy val ongoingEmploymentOption = circs.questionGroup[CircumstancesStartedEmploymentAndOngoing]
    lazy val finishedEmploymentOption = circs.questionGroup[CircumstancesStartedAndFinishedEmployment]
    lazy val futureEmploymentOption = circs.questionGroup[CircumstancesEmploymentNotStarted]

    val show =
        if (ongoingEmploymentOption.isDefined)
            ongoingEmploymentOption.get.payIntoPension.answer == "yes"
        else if (finishedEmploymentOption.isDefined)
            finishedEmploymentOption.get.payIntoPension.answer == "yes"
        else if (futureEmploymentOption.isDefined)
            futureEmploymentOption.get.payIntoPension.answer == "yes"
        else false

    show
}

@common.govMain(Messages("circs.thankyou")) {

    <div class="carers-allowance">

        @common.protoType()

        @common.feedback()

        <article class="finish-statement">
        
            <div class="app-complete">
	            <h1><span>@Html(Messages("circs.thankyou"))</span></h1>            
	            <p>@Html(Messages("circs.received"))</p>
            </div>

                @if(showBreaksInCareMessages){
                    <section class="finish-next prompt helper-prompt">
                        <h3 id="breaksInCareMessageTitle">@Html(Messages("circs.thankyou.breakmessage.title"))</h3>
                        <p>@Html(Messages("circs.thankyou.breakmessage.content"))</p>
                    </section>
                }

                @if(showEmployment1Messages){
                    <section class="finish-next prompt helper-prompt">
                        <h3 id="employment1MessageTitle">@Html(Messages("circs.thankyou.employment1message.title"))</h3>
                        <p>@Html(Messages("circs.thankyou.employment1message1.content"))</p>
                        <p>@Html(Messages("circs.thankyou.employment1message2.content"))</p>
                        @if(showEmploymentPensionMessage) {
                            <p>@Html(Messages("circs.thankyou.employment1message3.content"))</p>
                        }
                        <h3 id="employment1MessageAddressTitle">@Html(Messages("circs.thankyou.employment1message.address.title"))</h3>
                        <p>@Html(Messages("circs.thankyou.employment1message1.address"))</p>
                        <p>@Html(Messages("circs.thankyou.employment1message2.address"))</p>
                        <p>@Html(Messages("circs.thankyou.employment1message3.address"))</p>
                        <p>@Html(Messages("circs.thankyou.employment1message4.address"))</p>
                    </section>
                }

                @if(showEmployment2Messages){
                    <section class="finish-next prompt helper-prompt">
                        <h3 id="employment2MessageTitle">@Html(Messages("circs.thankyou.employment2message.title"))</h3>
                        <p>@Html(Messages("circs.thankyou.employment2message1.content"))</p>
                        <p>@Html(Messages("circs.thankyou.employment2message2.content"))</p>
                        <p>@Html(Messages("circs.thankyou.employment2message3.content"))</p>
                        @if(showEmploymentPensionMessage) {
                            <p>@Html(Messages("circs.thankyou.employment2message4.content"))</p>
                        }
                        <h3 id="employment1MessageAddressTitle">@Html(Messages("circs.thankyou.employment2message.address.title"))</h3>
                        <p>@Html(Messages("circs.thankyou.employment2message1.address"))</p>
                        <p>@Html(Messages("circs.thankyou.employment2message2.address"))</p>
                        <p>@Html(Messages("circs.thankyou.employment2message3.address"))</p>
                        <p>@Html(Messages("circs.thankyou.employment2message4.address"))</p>
                    </section>
                }

                <section class="finish-next prompt helper-prompt">
	            <h3>@Html(Messages("next"))</h3>
	            <ul>
	                <li>@Html(Messages("circs.next.1"))</li>
	                <li>@Html(Messages("next.last"))</li>
	            </ul>
	            </section>
	            <section>
	            <h3>@Html(Messages("change.head"))</h3>
	            <p>@Html(Messages("change.link"))</p>
	            </section>
	            <section>
	            <p class="finish">@Html(Messages("circs.feedback.link"))</p>
	            </section>
	            
            
        </article>
    </div>
}